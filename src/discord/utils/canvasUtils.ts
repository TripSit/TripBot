import Canvas from '@napi-rs/canvas';

export function resizeText(canvas: Canvas.Canvas, text: string, startingSize: number, textFont: string, maxLength: number): string {
  const context = canvas.getContext('2d');
  let fontSize = startingSize;
  do {
    fontSize -= 1;
    context.font = `${fontSize}px ${textFont}`;
  } while (context.measureText(text).width > maxLength);
  return context.font;
}

const normalAlphabet = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz';
const fancyAlphabets = [
  Array.from('ð“ð“‘ð“’ð““ð“”ð“•ð“–ð“—ð“˜ð“™ð“šð“›ð“œð“ð“žð“Ÿð“ ð“¡ð“¢ð“£ð“¤ð“¥ð“¦ð“§ð“¨ð“©ð“ªð“«ð“¬ð“­ð“®ð“¯ð“°ð“±ð“²ð“³ð“´ð“µð“¶ð“·ð“¸ð“¹ð“ºð“»ð“¼ð“½ð“¾ð“¿ð”€ð”ð”‚ð”ƒ'),
  Array.from('ð’œðµð’žð’Ÿð¸ð¹ð’¢ð»ð¼ð’¥ð’¦ð¿ð‘€ð’©ð’ªð’«ð’¬ð‘…ð’®ð’¯ð’°ð’±ð’²ð’³ð’´ð’µð’¶ð’·ð’¸ð’¹ð‘’ð’»ð‘”ð’½ð’¾ð’¿ð“€ð“ð“‚ð“ƒð‘œð“…ð“†ð“‡ð“ˆð“‰ð“Šð“‹ð“Œð“ð“Žð“'),
  Array.from('ð”„ð”…â„­ð”‡ð”ˆð”‰ð”Šâ„Œâ„‘ð”ð”Žð”ð”ð”‘ð”’ð”“ð””â„œð”–ð”—ð”˜ð”™ð”šð”›ð”œâ„¨ð”žð”Ÿð” ð”¡ð”¢ð”£ð”¤ð”¥ð”¦ð”§ð”¨ð”©ð”ªð”«ð”¬ð”­ð”®ð”¯ð”°ð”±ð”²ð”³ð”´ð”µð”¶ð”·'),
  Array.from('ð•¬ð•­ð•®ð•¯ð•°ð•±ð•²ð•³ð•´ð•µð•¶ð•·ð•¸ð•¹ð•ºð•»ð•¼ð•½ð•¾ð•¿ð–€ð–ð–‚ð–ƒð–„ð–…ð–†ð–‡ð–ˆð–‰ð–Šð–‹ð–Œð–ð–Žð–ð–ð–‘ð–’ð–“ð–”ð–•ð––ð–—ð–˜ð–™ð–šð–›ð–œð–ð–žð–Ÿ'),
  Array.from('ð”¸ð”¹â„‚ð”»ð”¼ð”½ð”¾â„ð•€ð•ð•‚ð•ƒð•„â„•ð•†â„™â„šâ„ð•Šð•‹ð•Œð•ð•Žð•ð•â„¤ð•’ð•“ð•”ð••ð•–ð•—ð•˜ð•™ð•šð•›ð•œð•ð•žð•Ÿð• ð•¡ð•¢ð•£ð•¤ð•¥ð•¦ð•§ð•¨ð•©ð•ªð•«'),
  Array.from('ï¼¡ï¼¢ï¼£ï¼¤ï¼¥ï¼¦ï¼§ï¼¨ï¼©ï¼ªï¼«ï¼¬ï¼­ï¼®ï¼¯ï¼°ï¼±ï¼²ï¼³ï¼´ï¼µï¼¶ï¼·ï¼¸ï¼¹ï¼ºï½ï½‚ï½ƒï½„ï½…ï½†ï½‡ï½ˆï½‰ï½Šï½‹ï½Œï½ï½Žï½ï½ï½‘ï½’ï½“ï½”ï½•ï½–ï½—ï½˜ï½™ï½š'),
  Array.from('á´€Ê™á´„á´…á´‡êœ°É¢ÊœÉªá´Šá´‹ÊŸá´É´á´á´˜QÊ€êœ±á´›á´œá´ á´¡xÊá´¢á´€Ê™á´„á´…á´‡êœ°É¢ÊœÉªá´Šá´‹ÊŸá´É´á´á´˜QÊ€êœ±á´›á´œá´ á´¡xÊá´¢'),
  Array.from('ðŸ„°ðŸ„±ðŸ„²ðŸ„³ðŸ„´ðŸ„µðŸ„¶ðŸ„·ðŸ„¸ðŸ„¹ðŸ„ºðŸ„»ðŸ„¼ðŸ„½ðŸ„¾ðŸ„¿ðŸ…€ðŸ…ðŸ…‚ðŸ…ƒðŸ…„ðŸ……ðŸ…†ðŸ…‡ðŸ…ˆðŸ…‰ðŸ„°ðŸ„±ðŸ„²ðŸ„³ðŸ„´ðŸ„µðŸ„¶ðŸ„·ðŸ„¸ðŸ„¹ðŸ„ºðŸ„»ðŸ„¼ðŸ„½ðŸ„¾ðŸ„¿ðŸ…€ðŸ…ðŸ…‚ðŸ…ƒðŸ…„ðŸ……ðŸ…†ðŸ…‡ðŸ…ˆðŸ…‰'),
  Array.from('â’¶â’·â’¸â’¹â’ºâ’»â’¼â’½â’¾â’¿â“€â“â“‚â“ƒâ“„â“…â“†â“‡â“ˆâ“‰â“Šâ“‹â“Œâ“â“Žâ“â“â“‘â“’â““â“”â“•â“–â“—â“˜â“™â“šâ“›â“œâ“â“žâ“Ÿâ“ â“¡â“¢â“£â“¤â“¥â“¦â“§â“¨â“©'),
  Array.from('à¸„à¹’Ï‚à¹”Ñ”Å¦ï»®Ñ’à¹€×ŸÐºÉ­à¹“à¸ à¹×§á»£Ð³à¸£Õ‡à¸¢×©à¸¬××¥Õ¹à¸„à¹’Ï‚à¹”Ñ”Å¦ï»®Ñ’à¹€×ŸÐºÉ­à¹“à¸ à¹×§á»£Ð³à¸£Õ‡à¸¢×©à¸¬××¥Õ¹'),
  Array.from('ABCDEFGHIJKLMNOPQRSTUVWXYZÎ±á‚¦ÆˆÔƒÒ½ÏÉ Ô‹Î¹ÊÆ™Ê…É±É³ÏƒÏÏ™É¾Ê‚ÆšÏ…Ê‹É¯xáƒ§È¥'),
  Array.from('ÇŸÉ®ÆˆÉ–É›Ê„É¢É¦É¨ÊÓ„ÊŸÊÕ¼Ö…Ö„Õ¦Ê€Ö†È¶ÊŠÊ‹Õ¡Ó¼ÊÊÇŸÉ®ÆˆÉ–É›Ê„É¢É¦É¨ÊÓ„ÊŸÊÕ¼Ö…Ö„Õ¦Ê€Ö†È¶ÊŠÊ‹Õ¡Ó¼ÊÊ'),
  Array.from('á—á°áˆáŽ´á‹áŽ¦áŽ¶á‚áŽ¥á á¦ááŽ·ááŽ§áŽ®áŽ¤á’á•á–á¬á‰á‡áŒ€áŽ©ášá—á°áˆáŽ´á‹áŽ¦áŽ¶á‚áŽ¥á á¦ááŽ·ááŽ§áŽ®áŽ¤á’á•á–á¬á‰á‡áŒ€áŽ©áš'),
  Array.from('Ä…áƒªÆˆÉ–É›Ê„É É§Ä±ÊÆ™Æ–É±Å‹Æ¡â„˜Õ¦à½žÊ‚É¬Å³Û·á¿³Ò³áƒ§Ê‘Ä…áƒªÆˆÉ–É›Ê„É É§Ä±ÊÆ™Æ–É±Å‹Æ¡â„˜Õ¦à½žÊ‚É¬Å³Û·á¿³Ò³áƒ§Ê‘'),
  Array.from('à¸„à¹–Â¢à»“Ä“fàº‡hià¸§klà¹“àº–à»pà¹‘rÅžtà¸™à¸‡àºŸxà¸¯àºŠà¸„à¹–Â¢à»“Ä“fàº‡hià¸§klà¹“àº–à»pà¹‘rÅžtà¸™à¸‡àºŸxà¸¯àºŠ'),
  Array.from('ð€ðð‚ðƒð„ð…ð†ð‡ðˆð‰ðŠð‹ðŒððŽððð‘ð’ð“ð”ð•ð–ð—ð˜ð™ðšð›ðœððžðŸð ð¡ð¢ð£ð¤ð¥ð¦ð§ð¨ð©ðªð«ð¬ð­ð®ð¯ð°ð±ð²ð³'),
  Array.from('ð˜ˆð˜‰ð˜Šð˜‹ð˜Œð˜ð˜Žð˜ð˜ð˜‘ð˜’ð˜“ð˜”ð˜•ð˜–ð˜—ð˜˜ð˜™ð˜šð˜›ð˜œð˜ð˜žð˜Ÿð˜ ð˜¡ð˜¢ð˜£ð˜¤ð˜¥ð˜¦ð˜§ð˜¨ð˜©ð˜ªð˜«ð˜¬ð˜­ð˜®ð˜¯ð˜°ð˜±ð˜²ð˜³ð˜´ð˜µð˜¶ð˜·ð˜¸ð˜¹ð˜ºð˜»'),
  Array.from('ð˜¼ð˜½ð˜¾ð˜¿ð™€ð™ð™‚ð™ƒð™„ð™…ð™†ð™‡ð™ˆð™‰ð™Šð™‹ð™Œð™ð™Žð™ð™ð™‘ð™’ð™“ð™”ð™•ð™–ð™—ð™˜ð™™ð™šð™›ð™œð™ð™žð™Ÿð™ ð™¡ð™¢ð™£ð™¤ð™¥ð™¦ð™§ð™¨ð™©ð™ªð™«ð™¬ð™­ð™®ð™¯'),
  Array.from('ð™°ð™±ð™²ð™³ð™´ð™µð™¶ð™·ð™¸ð™¹ð™ºð™»ð™¼ð™½ð™¾ð™¿ðš€ðšðš‚ðšƒðš„ðš…ðš†ðš‡ðšˆðš‰ðšŠðš‹ðšŒðšðšŽðšðšðš‘ðš’ðš“ðš”ðš•ðš–ðš—ðš˜ðš™ðššðš›ðšœðšðšžðšŸðš ðš¡ðš¢ðš£'),
  Array.from('Î›Bá„ƒDÎ£FGÎ‰IJKá„‚MÐŸÓ¨PQÐ¯Æ§Æ¬Ð¦VÐ©XYZÎ›Bá„ƒDÎ£FGÎ‰IJKá„‚MÐŸÓ¨PQÐ¯Æ§Æ¬Ð¦VÐ©XYZ'),
  Array.from('Î±Ð²Â¢âˆ‚Ñ”Æ’gÐ½Î¹× Ðºâ„“Ð¼Î·ÏƒÏqÑÑ•Ñ‚Ï…Î½Ï‰Ï‡ÑƒzÎ±Ð²Â¢âˆ‚Ñ”Æ’gÐ½Î¹× Ðºâ„“Ð¼Î·ÏƒÏqÑÑ•Ñ‚Ï…Î½Ï‰Ï‡Ñƒz'),
  Array.from('Ã„ÃŸÃ‡ÃÃˆÂ£GHÃŒJKLMÃ±Ã–Ã¾QRÂ§â€ ÃšVWÃ—Â¥ZÃ¥ÃŸÂ¢ÃÃªÂ£ghÃ¯jklmÃ±Ã°Ã¾qrÂ§â€ ÂµvwxÂ¥z'),
  Array.from('â‚³à¸¿â‚µÄÉ†â‚£â‚²â±§Å‚Jâ‚­â± â‚¥â‚¦Ã˜â‚±Qâ±¤â‚´â‚®É„Vâ‚©Ó¾ÉŽâ±«â‚³à¸¿â‚µÄÉ†â‚£â‚²â±§Å‚Jâ‚­â± â‚¥â‚¦Ã˜â‚±Qâ±¤â‚´â‚®É„Vâ‚©Ó¾ÉŽâ±«'),
  Array.from('ÈºÎ²â†»áŽ ÆÆ‘Æ“Ç¶Ä¯Ù„Ò êˆâ±®áž à¶§Ï†Ò¨à½ ÏšÍ²Ô±á»¼à°šáƒ¯Ó‹É€Ä…ÒÃ§ÕªÒ½Æ’ÖÕ°Ã¬ÊÒŸÓ€ÊÕ²Ö…Ö„Õ¦É¾Ê‚Õ§Õ´ÑµÕ¡Ã—Õ¾Õ€'),
  Array.from('á—©á—·á‘•á—ªEá–´Gá•¼Iá’Ká’ªá—°á‘ŽOá‘­á‘«á–‡á”•Tá‘Œá¯á—¯á™­Yá˜”á—©á—·á‘•á—ªEá–´Gá•¼Iá’Ká’ªá—°á‘ŽOá‘­á‘«á–‡á”•Tá‘Œá¯á—¯á™­Yá˜”'),
  Array.from('á—©á—·á‘¢á•²á˜¿á–´á˜œá•¼á“°á’šá–½á¸á’ªá˜»á˜‰á“á•µá•´á–‡Sá–¶á‘˜áºá˜ºá™­á–»á—±á—©á—·á‘¢á•²á˜¿á–´á˜œá•¼á“°á’šá–½á¸á’ªá˜»á˜‰á“á•µá•´á–‡Sá–¶á‘˜áºá˜ºá™­á–»á—±'),
];

export function deFuckifyText(text: string): string {
  const normalAlphabetArray = Array.from(normalAlphabet);
  return Array.from(text).map(char => {
    if (/^[\x20-\x7E]$/g.test(char)) {
      return char;
    }
    for (let i = 0; i < fancyAlphabets.length; i += 1) {
      const index = fancyAlphabets[i].indexOf(char);
      if (index !== -1) {
        return normalAlphabetArray[index];
      }
    }
    if (normalAlphabet.includes(char)) {
      return char;
    }
    return '';
  }).join('');
}

export const colorDefs = {
  [env.ROLE_PURPLE]: {
    cardDarkColor: '#19151e',
    cardLightColor: '#2d2636',
    chipColor: '#47335f',
    barColor: '#9661d9',
    textColor: '#b072ff',
  },
  [env.ROLE_BLUE]: {
    cardDarkColor: '#161d1f',
    cardLightColor: '#283438',
    chipColor: '#3a5760',
    barColor: '#4baccc',
    textColor: '#5acff5',
  },
  [env.ROLE_GREEN]: {
    cardDarkColor: '#151a16',
    cardLightColor: '#252e28',
    chipColor: '#31543d',
    barColor: '#59b879',
    textColor: '#6de194',
  },
  [env.ROLE_PINK]: {
    cardDarkColor: '#1e151b',
    cardLightColor: '#352530',
    chipColor: '#5f324f',
    barColor: '#d95dae',
    textColor: '#ff6dcd',
  },
  [env.ROLE_RED]: {
    cardDarkColor: '#1f1616',
    cardLightColor: '#382727',
    chipColor: '#613838',
    barColor: '#d95152',
    textColor: '#ff5f60',
  },
  [env.ROLE_ORANGE]: {
    cardDarkColor: '#1d1814',
    cardLightColor: '#342b24',
    chipColor: '#5f422e',
    barColor: '#d98b51',
    textColor: '#ffa45f',
  },
  [env.ROLE_YELLOW]: {
    cardDarkColor: '#1d1b14',
    cardLightColor: '#333024',
    chipColor: '#5e532d',
    barColor: '#d6b94e',
    textColor: '#ffdd5d',
  },
  [env.ROLE_WHITE]: {
    cardDarkColor: '#242424',
    cardLightColor: '#404040',
    chipColor: '#666666',
    barColor: '#b3b3b3',
    textColor: '#dadada',
  },
  [env.ROLE_DONOR_BLACK]: {
    cardDarkColor: '#0e0e0e',
    cardLightColor: '#181818',
    chipColor: '#262626',
    barColor: '#595959',
    textColor: '#626262',
  },
  [env.ROLE_DONOR_PURPLE]: {
    cardDarkColor: '#1a1222',
    cardLightColor: '#272235',
    chipColor: '#432767',
    barColor: '#7f38d9',
    textColor: '#9542ff',
  },
  [env.ROLE_DONOR_BLUE]: {
    cardDarkColor: '#0c171d',
    cardLightColor: '#1b2830',
    chipColor: '#2f4f5f',
    barColor: '#1da2cc',
    textColor: '#22bef0',
  },
  [env.ROLE_DONOR_GREEN]: {
    cardDarkColor: '#0f1f12',
    cardLightColor: '#203827',
    chipColor: '#275c39',
    barColor: '#36b360',
    textColor: '#45e47b',
  },
  [env.ROLE_DONOR_PINK]: {
    cardDarkColor: '#25141c',
    cardLightColor: '#412438',
    chipColor: '#682b52',
    barColor: '#d93fa4',
    textColor: '#ff4ac1',
  },
  [env.ROLE_DONOR_RED]: {
    cardDarkColor: '#210e0e',
    cardLightColor: '#3e211f',
    chipColor: '#662526',
    barColor: '#d93335',
    textColor: '#ff3c3e',
  },
  [env.ROLE_DONOR_ORANGE]: {
    cardDarkColor: '#211710',
    cardLightColor: '#3f2c20',
    chipColor: '#664225',
    barColor: '#d96c36',
    textColor: '#ff913b',
  },
  [env.ROLE_DONOR_YELLOW]: {
    cardDarkColor: '#211e0f',
    cardLightColor: '#3d361f',
    chipColor: '#655721',
    barColor: '#d9bc4f',
    textColor: '#ffd431',
  },
} as {
  [key: string]: {
    cardDarkColor: string;
    cardLightColor: string;
    chipColor: string;
    barColor: string;
    textColor: string;
  };
};

function hexToHSL(H: string): [number, number, number] {
  let r = 0; let g = 0; let
    b = 0;
  if (H.length == 4) {
    r = parseInt(`0x${H[1]}${H[1]}`, 16);
    g = parseInt(`0x${H[2]}${H[2]}`, 16);
    b = parseInt(`0x${H[3]}${H[3]}`, 16);
  } else if (H.length == 7) {
    r = parseInt(`0x${H[1]}${H[2]}`, 16);
    g = parseInt(`0x${H[3]}${H[4]}`, 16);
    b = parseInt(`0x${H[5]}${H[6]}`, 16);
  }
  r /= 255;
  g /= 255;
  b /= 255;
  const max = Math.max(r, g, b); const
    min = Math.min(r, g, b);
  let h = 0; let s = 0; const
    l = (max + min) / 2;

  if (max != min) {
    const d = max - min;
    s = l > 0.5 ? d / (2 - max - min) : d / (max + min);
    switch (max) {
      case r: h = (g - b) / d + (g < b ? 6 : 0); break;
      case g: h = (b - r) / d + 2; break;
      case b: h = (r - g) / d + 4; break;
    }
    h /= 6;
  }
  return [h * 360, s * 100, l * 100];
}

function hslToHex(h: number, s: number, l: number): string {
  s /= 100;
  l /= 100;
  const a = s * Math.min(l, 1 - l);
  const f = (n: number) => {
    const k = (n + h / 30) % 12;
    const color = l - a * Math.max(Math.min(k - 3, 9 - k, 1), -1);
    return Math.round(255 * color).toString(16).padStart(2, '0');
  };
  return `#${f(0)}${f(8)}${f(4)}`;
}

export function generateColors(baseHex: string, hueModifier: number, saturationModifier: number, lightnessModifier: number): string {
  // Convert the base Hex color to HSL
  let [h, s, l] = hexToHSL(baseHex);

  // Apply the modifier amounts
  h = (h + hueModifier) % 360;
  s = Math.max(0, s * (1 + saturationModifier / 100));
  l = Math.max(0, l * (1 + lightnessModifier / 100));

  // Convert the modified HSL color back to Hex and return it
  return hslToHex(h, s, l);
}
